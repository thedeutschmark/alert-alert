<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>deutschmark's Alert Creator</title>
    <link rel="stylesheet" href="/static/css/style.css">
</head>
<body>
    <header>
        <h1>deutschmark's Alert Creator</h1>
    </header>

    <!-- Dependency check banner -->
    <div id="dep-banner" class="banner hidden">
        <p id="dep-message"></p>
    </div>

    <main>
        <!-- Step 1: YouTube URL -->
        <section class="step" id="step-1">
            <h2><span class="step-num">1</span> Video Source</h2>
            <div class="step-content">
                <div class="input-row">
                    <input type="text" id="url-input" placeholder="Paste YouTube URL here..." spellcheck="false">
                    <button id="validate-btn" onclick="App.validateUrl()">Validate</button>
                </div>
                <div id="video-info" class="hidden">
                    <p class="info-label">Title: <span id="video-title"></span></p>
                    <p class="info-label">Duration: <span id="video-duration"></span></p>
                </div>
                <div id="step1-error" class="error-msg hidden"></div>
            </div>
        </section>

        <!-- Step 2: Timestamps -->
        <section class="step disabled" id="step-2">
            <h2><span class="step-num">2</span> Timestamps</h2>
            <div class="step-content">
                <div class="input-row">
                    <label>
                        Start
                        <input type="text" id="start-input" placeholder="0:00" class="time-input">
                    </label>
                    <label>
                        End
                        <input type="text" id="end-input" placeholder="0:15" class="time-input">
                    </label>
                    <span id="clip-duration" class="info-label"></span>
                </div>
                
                <!-- Separate Audio Source Toggle -->
                <div class="audio-source-toggle">
                    <label class="toggle-label">
                        <input type="checkbox" id="use-separate-audio">
                        <span class="toggle-text">Use separate audio source</span>
                    </label>
                </div>
                
                <!-- Separate Audio Source Section (hidden by default) -->
                <div id="audio-source-section" class="hidden audio-source-section">
                    <div class="audio-source-header">
                        <span class="audio-icon">ðŸŽµ</span>
                        <span>Audio Source</span>
                    </div>
                    <div class="input-row">
                        <input type="text" id="audio-url-input" placeholder="Paste YouTube URL for audio..." spellcheck="false">
                        <button id="validate-audio-btn" onclick="App.validateAudioUrl()">Validate</button>
                    </div>
                    <div id="audio-video-info" class="hidden">
                        <p class="info-label">Title: <span id="audio-video-title"></span></p>
                        <p class="info-label">Duration: <span id="audio-video-duration"></span></p>
                    </div>
                    <div class="input-row">
                        <label>
                            Audio Start
                            <input type="text" id="audio-start-input" placeholder="0:00" class="time-input">
                        </label>
                        <label>
                            Audio End
                            <input type="text" id="audio-end-input" placeholder="0:15" class="time-input">
                        </label>
                        <span id="audio-clip-duration" class="info-label"></span>
                    </div>
                    <div id="audio-url-error" class="error-msg hidden"></div>
                </div>
                
                <div class="input-row" style="margin-top: 1rem;">
                    <button id="download-btn" onclick="App.downloadClip()">Download Clip</button>
                </div>
                <div id="download-status" class="hidden">
                    <span class="spinner"></span> <span id="download-status-text">Downloading...</span>
                </div>
                <div id="step2-error" class="error-msg hidden"></div>
            </div>
        </section>

        <!-- Step 3: Crop Preview -->
        <section class="step disabled" id="step-3">
            <h2><span class="step-num">3</span> Crop Preview</h2>
            <div class="step-content">
                <div id="crop-wrapper">
                    <div id="crop-container">
                        <img id="crop-image" draggable="false" alt="Video frame preview">
                        <div id="crop-overlay"></div>
                    </div>
                </div>
                <div class="crop-controls">
                    <div class="slider-row">
                        <span class="slider-label">Frame</span>
                        <label>
                            <input type="range" id="frame-scrubber" min="0" max="100" value="0" step="1">
                        </label>
                    </div>
                    <div class="slider-row">
                        <span class="slider-label">Zoom</span>
                        <label>
                            <input type="range" id="zoom-slider" min="10" max="100" value="100" step="1">
                        </label>
                        <span id="zoom-value" class="slider-value">100%</span>
                    </div>
                    <p id="crop-coords" class="info-label">Crop: X=0 Y=0</p>
                </div>
            </div>
        </section>

        <!-- Step 4: Process & Export -->
        <section class="step disabled" id="step-4">
            <h2><span class="step-num">4</span> Process &amp; Export</h2>
            <div class="step-content">
                <button id="process-btn" onclick="App.processVideo()">Process Video</button>
                <div id="progress-section" class="hidden">
                    <div class="progress-bar-bg">
                        <div id="progress-bar" class="progress-bar-fill" style="width: 0%"></div>
                    </div>
                    <p id="progress-text" class="info-label">Starting...</p>
                </div>
                <div id="download-section" class="hidden">
                    <button id="export-btn" class="export-btn" onclick="App.downloadResult()">Download Alert</button>
                </div>
                <div id="step4-error" class="error-msg hidden"></div>
            </div>
        </section>
    </main>

    <script src="/static/js/crop.js"></script>
    <script src="/static/js/app.js"></script>
</body>
</html>
